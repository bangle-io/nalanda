import { Callout, Tabs, Tab } from 'nextra-theme-docs';
import { CodeBlockVanilla } from '../../components/CodeBlock';

# nalanda Documentation

<Callout type="caution">
Nalanda is still in early release. We are working hard to make it production ready.
</Callout>


## Installation

Use your preferred package manager to install:

<Tabs items={["npm", "yarn", "pnpm"]}>
  <Tab>  
```bash
# react codebase
npm install @nalanda/react

# other codebases
npm install @nalanda/core
```
  </Tab>


<Tab>
```bash
# react codebase
yarn add @nalanda/react 

# other codebases
yarn add @nalanda/core
```
</Tab>

<Tab>
```bash
# react codebase
pnpm install @nalanda/react

# other codebases
pnpm install @nalanda/core
```
</Tab>
</Tabs>

<Callout type="info">

`@nalanda/core` is the core library that can be used with any framework.
 Read more about using Nalanda with <bold>other frameworks</bold> [here](/docs/advanced-topics/other-frameworks/).

</Callout>

## Creating a Slice

Start by crafting a simple counter slice:

```tsx copy filename="counterSlice.ts"
import { createKey } from '@nalanda/react';

// The key is a local helper used to define various components of your slice.
const key = createKey('counterSlice', []);

// State fields define part of your state.
const counter = key.field(0);

// Actions define how a field/s should be updated.
function increment() {
  return counter.update((c) => c + 1);
}

// A slice serves as an interface, revealing the specified fields
// and actions to the entire application.
export const counterSlice = key.slice({
  counter,
  increment
});
```



## Setting up the Store

At the root of your React app, set up a store and encapsulate your app with the StoreProvider component:

```tsx copy filename="app.tsx"
import { createStore, StoreProvider } from '@nalanda/react';
import { counterSlice } from './counterSlice';

// Establish a global store incorporating your slices.
const store = createStore({
  slices: [counterSlice],
});

ReactDOM.render(
  <StoreProvider store={store}>
    <App />
  </StoreProvider>,
  document.getElementById('root')
);
```


## Displaying the counter

With the store in place, employ the useSlice hook to access the state and actions from the slice:

```tsx copy filename="counter.tsx"
import { useTrack, useStore } from '@nalanda/react';
import { counterSlice } from './counterSlice';

export function Counter() {
  // useTrack will re-render the component any time the `counter` value changes.
  const { counter } = useTrack(counterSlice);
  const store = useStore();

  const increment = () => {
    // Dispatch an action to update the slice
    store.dispatch(counterSlice.increment());
  };

  return (
    <div>
      <h1>Counter</h1>
      <p>{counter}</p>
      <button onClick={increment}>increment</button>
    </div>
  );
}
```


## Final Code

Below is the complete code for the counter example. This interactive example allows you to experiment with it:


<CodeBlockVanilla height={600}>
{`
import { useTrack, createKey, StoreProvider, useStore, createStore } from '@nalanda/react';

// key is local helper to define various things related to your slice
const key = createKey('counterSlice', []);

// state fields define the shape of your state
const counter = key.field(0);

// actions dicate how a field/s should be updated
function increment() {
  return counter.update((c) => c + 1);
}

// slice acts as an interface, exposing the chosen fields and actions to
// the rest of the application.
export const counterSlice = key.slice({
  counter,
  increment
});

const store = createStore({
  slices: [counterSlice],
});


export default function App() {
  return <StoreProvider store={store}>
    <Counter />
    </StoreProvider>
}

export function Counter() {
  // useTrack re-render the component whenever \`counter\` changes
  const { counter } = useTrack(counterSlice);
  const store = useStore();

  const increment = () => {
    // Dispatch an action to update the slice
    store.dispatch(counterSlice.increment());
  };

  return (
    <div>
      <h1>Counter</h1>
      <p>{counter}</p>
      <button onClick={increment}>increment</button>
    </div>
  );
}
`}
</CodeBlockVanilla>
